{% extends 'forum/topic/list.html' %}

{% load i18n humanize %}

{% block title %}
	{{ topic }}
{% endblock %}

{% block breadcrumbs %}
	{{ block.super }}
	<a href="{% url 'forum:topic_detail' category_slug=category.slug slug=topic.slug %}" class="breadcrumb-item" >
		<i class="fa fa-hashtag"></i>
		{{ topic }}
	</a>
{% endblock %}

{%  block page_title %}
	{{ topic }}
{% endblock %}

{% block content %}

	<div class="col-md-6">
		<form class="full-width" action="#" method="post" {% if form.is_multipart %} enctype="multipart/form-data" {% endif %}>
			{% csrf_token %}

			{% include 'base/_form_fields.html' %}

			<div class="container-fluid">
				<div class="float-xs-right">
					{% if comment_edit %}
					<a href="{% url 'forum:topic_detail' category_slug=category.slug slug=topic.slug %}" class="btn btn-secondary">
						<i class="fa fa-minus-circle"></i>
						{% trans "Cancel" %}
					</a>
					{% endif %}
					<button type="submit" tabindex="{{ form.visible_fields|length|add:1 }}" class="btn btn-primary">{% trans "Save" %}</button>
				</div>
			</div>
		</form>
	</div>
	<div class="col-md-6">
		<div id="MathPreview" style="border:1px solid; padding: 3px; width:100%; margin-top:5px"></div>
		<div id="MathBuffer"></div>
	</div>

	<table class="table table-bordered table-hover text">
		<thead>
			<tr>
				<th>{% trans "User" %}</th>
				<th>{% trans "Text" %}</th>
				<th>{% trans "Date" %}</th>
				<th>{% trans "Options" %}</th>
			</tr>
		</thead>

		<tbody>
			{% for comment in page_obj %}
				<tr>
					<td>{{ comment.user }}</td>
					<td>{{ comment.text }}</td>
					<td>{{ comment.date|naturaltime }}</td>
					<td>
						{% ifequal comment.user request.user  %}
						<a href="{% url 'forum:topic_detail' category_slug=category.slug slug=topic.slug comment_id=comment.id %}" class="btn btn-primary btn-sm">
							<i class="fa fa-edit"></i>					
						</a>
						<a href="#" class="btn btn-danger btn-sm">
							<i class="fa fa-remove"></i>
						</a>
						{% endifequal %}
					</td>
				</tr>
			{% empty %}
				<tr>
					<td class="text-xs-center">{% trans "No comment found!" %}</td>
				</tr>
			{% endfor %}
		</tbody>
	</table>

	{% include "base/_paginate.html" %}
{% endblock %}

{% block js %}
	{{ block.super }}
	{% include "base/imports/latex.html" %}
	{% include "base/imports/latex_preview.html" with id='id_text' id_preview='MathPreview' id_buffer='MathBuffer'  %}
{% endblock %}